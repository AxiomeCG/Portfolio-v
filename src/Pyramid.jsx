/*
Auto-generated by: https://github.com/pmndrs/gltfjsx
*/

import React, {useEffect, useRef} from 'react';
import {Plane, useGLTF} from '@react-three/drei';
import {useFrame} from '@react-three/fiber';
import {landingPageConfig, showcaseConfig, state} from './state.js';
import {useSnapshot} from 'valtio';
import gsap from "gsap";
export function Pyramid(props) {
  const {nodes, materials} = useGLTF('/pyramid-rounded2.glb');

  const meshRef = useRef();

  useEffect(() => {

    if (props.progress !== 0) {
      gsap.timeline().to(meshRef.current.rotation, {
        y: 0,
        x: 0,
        z: Math.PI * 0.35,
        duration: 3,
      }).to(meshRef.current.scale, {
        x: 6,
        y: 6,
        z: 6,
        duration: 3,
      }, '<1')
    } else {
      gsap.timeline().to(meshRef.current.scale, {
        x: 1,
        y: 1,
        z: 1,
        duration: 3,
      }, ).to(meshRef.current.rotation, {
        y: 0,
        x: 0,
        z: 0,
        duration: 3,
      }, '<1')
    }
  }, [props.progress]);

  useFrame((state, delta) => {
    if (props.progress === 0) {
      meshRef.current.rotation.y += delta * 0.5;
      meshRef.current.rotation.x += delta * 0.1;
    } else {
      meshRef.current.rotation.z -= delta * 0.25;

    }
  })
  const snapshot = useSnapshot(state)



  return (
    <group {...props} dispose={null}>
      <mesh ref={meshRef}
            castShadow
            receiveShadow
            geometry={nodes.Cone.geometry}
      >
        {props.children}
      </mesh>


    </group>
  );
}

useGLTF.preload('/pyramid-rounded2.glb');
